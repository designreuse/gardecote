<html xmlns:th="http://www.thymleaf.org" xmlns="http://www.w3.org/1999/xhtml" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/sitelayout">

<head>
    <meta charset="UTF-8" />
    <title>Gestion des documents</title>
</head>
<body>

<div   layout:fragment="content">
    <span class="label label-danger" th:text="${deletefeedback}"></span>
    <span class="label label-danger" th:text="${deblocagefeedback}"></span>
 <form th:action="@{createDocument}" method="post"  th:object="${frmSearchPgsForDocCrea}" class="form-inline" >
     <div class="jumbotron text-left">

  <select class="form-control"   th:field="${frmSearchPgsForDocCrea.typeDoc}"   >
             <option th:each="i : ${allTypesDoc}"
                     th:value="${i}"
                     th:text="${i}">

             </option>
  </select>
         <label  >Numéro de debut:</label>
         <input type="text"  th:field="${frmSearchPgsForDocCrea.numeroDebut}" onchange="clearFields()"/>
         <span class="label label-danger" th:errors="${frmSearchPgsForDocCrea.numeroDebut}"></span>
         <button type="button" id="but" name="but" ><span class="glyphicon glyphicon-search"></span></button>




    <div id="dependentContent">
        <label th:fragment="finListFrag"  >Numero page fin :</label>

            <select class="form-control"  th:disabled="${frmSearchPgsForDocCrea.displaydatefrg}" th:field="${frmSearchPgsForDocCrea.numeroFin}" th:fragment="finListFrag"  >
                <option th:each="i : ${frmSearchPgsForDocCrea.numsfin}"
                        th:value="${i}"
                        th:text="${i}">

               </option>
            </select>
        <span class="label label-danger" th:errors="${frmSearchPgsForDocCrea.numeroFin}"></span>

        <label th:fragment="finListFrag" >Date de premier jour du marree :</label>
        <input  th:disabled="${frmSearchPgsForDocCrea.displaydatefrg}" type="date" class="form-control " th:field="${frmSearchPgsForDocCrea.dateDebut}"   th:fragment="finListFrag"/>
        <span class="label label-danger" th:errors="${frmSearchPgsForDocCrea.dateDebut}"></span>
        <label th:fragment="finListFrag" >Date de dernier jour du marree :</label>


        <input  th:disabled="${frmSearchPgsForDocCrea.displaydatefrg}" type="date" class="form-control " th:field="${frmSearchPgsForDocCrea.dateRetour}"   th:fragment="finListFrag"/>
        <span class="label label-danger" th:errors="${frmSearchPgsForDocCrea.dateRetour}"></span>

       <button type="submit"  id="creer" name="creer" th:disabled="${frmSearchPgsForDocCrea.displayButton}" class="btn btn-lg btn-primary"  th:fragment="finListFrag" onsubmit="return confirm('Are you sure?');"> creer document &raquo; </button>

    </div>
</div>

</form>



    <table class="table table-striped table-bordered table-hover">
        <thead>
        <tr>
            <th></th>
            <th>Depart</th>
            <th>Retour</th>
            <th>Navire</th>
            <th>Page Debut</th>
            <th>Page fin</th>
            <th>enumtypedoc</th>
            <th>Ref contrat</th>
            <th>Concessionnaire</th>
       </tr>
        </thead>
        <tbody>
        <tr th:each="b:${frmSearchPgsForDocCrea.lstDocuments}">
          <td>  <div class="dropdown">  <button th:field="${frmSearchPgsForDocCrea.numSelected}" class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Actions
                <span class="caret"></span></button>
                <ul class="dropdown-menu">
                    <li th:if="${#strings.equals(b.enumtypedoc,'Journal_Peche')}" >
                        <a  th:href="@{ajouterAnnexe(numimm=${b.numImm},typeDoc=${b.enumtypedoc},depart=${b.depart},action='ajouterAnnexe')}"   onclick="return confirm('Are you sure?');" >JP Annexe</a>
                    </li>
                    <li th:if="${b.debloquerModification}">
                     <a  th:href="@{editDoc(numimm=${b.numImm},typeDoc=${b.enumtypedoc},depart=${b.depart},action='modifyDoc')}" onclick="return confirm('Are you sure?');" >Editer</a>
                    </li>
                    <li th:if="${b.bloquerDeletion}">
                      <a   th:href="@{deleteDoc(numimm=${b.numImm},depart=${b.depart},action='deleteDoc')}" onclick="return confirm('Are you sure?');">Supprimer</a>
                   </li>

                    <li>
                    <a th:if="${b.bloquerDeletion}" th:href="@{bloquerSuppression(numimm=${b.numImm},depart=${b.depart},action='bloquerDoc')}" onclick="return confirm('Are you sure?');">bloquer  la suppression</a>
                    <a th:unless="${b.bloquerDeletion}" th:href="@{debloquerSuppression(numimm=${b.numImm},depart=${b.depart},action='bloquerDoc')}" onclick="return confirm('Are you sure?');">Débloquer la suppression</a>
                </li>
                    <li>
                        <a th:if="${b.debloquerModification}" th:href="@{debloquerModification(numimm=${b.numImm},depart=${b.depart},action='bloquerDoc')}" onclick="return confirm('Are you sure?');">bloquer  la modification</a>
                        <a th:unless="${b.debloquerModification}" th:href="@{bloquerModification(numimm=${b.numImm},depart=${b.depart},action='bloquerDoc')}" onclick="return confirm('Are you sure?');">Débloquer la modification</a>
                    </li>
                </ul>


          </div></td>
            <td th:text="${b.depart}"></td>
            <td th:text="${b.retour}"></td>
            <td th:text="${b.qnavire!=null?b.qnavire.nomnav:b.qusine.nomUsine}"></td>
            <td th:text="${b.qseq.debut}"></td>
            <td th:text="${b.qseq.fin}"></td>

            <td th:text="${b.enumtypedoc}"></td>
            <td th:text="${b.qconcession!=null?b.qconcession.refConcession:'non applicable'}"></td>
            <td th:text="${b.qconcession!=null?b.qconcession.qconsignataire.nomconsignataire:'non applicable'}"></td>

        </tr>
        </tbody>
    </table>

    <div class="container">

        <ul class="nav nav-pills">
            <li th:each="p:${frmSearchPgsForDocCrea.numPages}"  th:class="${p==frmSearchPgsForDocCrea.pageCourante}?active:''">
                <a th:text="${p}" th:href="@{createDocument(page=${p})}"></a>
            </li>
        </ul>
    </div>





</div>
</body>
</html>
